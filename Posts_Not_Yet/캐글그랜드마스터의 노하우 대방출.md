---
title : 김상훈 - 캐글 그랜드마스터의 경진대회 노하우 대방출
---

### 캐글을 왜 해야할까요?

- 세계적으로 실력을 인정받기 위해서 - 취업 목적
  - 알만한 해외 회사에서 제안이 오기도 함.
  - 아이비리그 박사과정 제의까지.
- AI 개발자로 배우고 성장하기 위해서 - 개인 성장
  - 특유의 공유문화 - 코드, 토론 자료가 방대함.

### 캐글에서 실력을 인정받으려면?

- 랭킹 시스템 활용
  - 경진대회에서 높은 순위에 들어 포인트를 획득
  - 누적된 포인트로 순위가 매겨짐
- 티어 시스템 활용
  - 경진대회에서 메달을 따면 개수에 따라서 티어가 결정됨.
  - 총 4개 종목 중 가장 인기 있고 어려운 티어 - 컴피티션 그랜드 마스터
- 상위 랭커가 되려면?
  - 혼자서 경진대회에서 높은 등수를 획득하는 것이 중요함.
  - 팀으로 나가면 포인트를 n빵하게 됨.
- 그랜드 마스터가 되려면?
  - 5개 금메달 획득
  - 이 중 1개는 솔로 금메달이어야 함.

### 캐글 시작해보기

1) 회원가입

2) 참여할 대회 선택

- 대회 개최 목적에 따라
  - Featured : 상업 목적의 예측 대회
  - Research : 연구 목적의 대회
  - Getting Started & Playground : 초보자를 위한 학습 목적의 대회. 랭킹용 메달, 포인트 얻을 수 X
  - Analytics : 데이터 탐색
  - Recruitment : 리크루팅 목적의 대회
- 대회 제출 방식에 따라
  - General Competition : 리소스 제약이 없다. submission.csv 파일만 제출하면 됨.
  - Code Competition : 리소스 제약이 있다. 코드를 실행시켜서 submission.csv를 생성해야 함. submission.csv를 생성할 때 리소스 제한(GPU, CPU, RAM, 실행시간)이 있음. 쓸모 있는 모델을 만들도록 강제하는 효과가 있음.
- 대회를 선택해서 들어가면
  - 주제와 부연설명을 볼 수 있다. 
- `Join competition`을 통해 대회에 참가.

3) 데이터 다운로드

- `Data` 를 클릭해서 데이터 탭으로 이동. 
- 다운로드.

4) 대회를 위한 파이프라인 구축

![image-20210305163609459](C:\Users\mh\+ GitHub_io_2\assets\img\post-images\image-20210305163609459.png)

5) 캐글로 파이프라인을 빠르게 경험해보기 

- `Notebooks`로 들어가서, 오른쪽의 `Most Votes`를 선택
- 참고할 수 있는 여러 노트북이 나옴. 이 중 관심있는 노트북에 들어감.
- `Copy and Edit`를 클릭하여 내 계정에 해당 노트북을 가져옴.
- 계정에 완전히 저장하기 위해 `Save Version`을 클릭해야 함.
  - 숫자가 바뀌게 됨. → 클릭하면, 내 코드가 되고
  - submit 버튼을 클릭하면 리더보드에 제출도 가능해짐.

### 노하우 대방출

- 파이프라인의 (빠른/효율적) 반복
  - GPU 장비 : 학습속도가 빠를수록 파이프라인 반복 속도가 빨라짐
  - 캐글에서 상위권에 들기 위해 필수적임. (개인 장비로서)
  - colab은 보조로.
  - ![image-20210305164055320](C:\Users\mh\AppData\Roaming\Typora\typora-user-images\image-20210305164055320.png)
  - 비블로워 타입/블로워 타입 → 공기가 들어갈 수 있는 공간이 있어야함. GPU가 어느정도 온도가 올라가면 쓰로틀링에 걸림. → 더이상 온도를 올리지 않기 위해 자신의 성능을 끌어내리는 것. 따라서 블로워 타입의 GPU를 설치하는 것을 추천함.
  - ![image-20210305164651695](C:\Users\mh\AppData\Roaming\Typora\typora-user-images\image-20210305164651695.png)
  - 시간 투자
    - 수천팀이 참여하는 대회에서, 1~2달 동안 평일 하루 평균 `4시간` 이상 투자, 주말 하루 평균 `8시간` 이상 투자.
  - 본인만의 기본 코드
    - 어떤 데이터를 다루는 대회든 기본 코드에서 일부만 수정하면 됨.
    - 빠르게 파이프라인을 구축할 수 있고 실수가 적어지게 됨.
    - 다른 사람의 코드를 참고하여 본인 것으로 소화한 코드를 만드는 것이 필요하다.
    - 김상훈 마스터의 경우, github의 한 코드를 참고하여 3개월동안 3개의 금메달을 획득했다.

- 점수 개선 아이디어
  - Notebook 탭 참고
  - 다른 경쟁자들의 글을 참고하며, 대회 마지막 제출때까지 방심 X.
- (올바른 방향인지) 탄탄한 검증 전략
  - 검증 전략이 필요한 이유 : 최종 순위 하락을 피하기 위해. `Shake-Up`  - Public LB에 Overfitting을 피하기 위해 검증전략이 필요함.
  - 리더보드 제출 횟수 제한이 있음 : 보통 5회
  - '좋은 모델' : Training set에서 얻은 점수가 Test set에서도 비슷하게 나오는 모델
  - '검증 전략' : Test set에서 얻은 점수와 Training set에서 얻은 점수 갭을 줄이는 평가 방법
- ![image-20210305165205976](../../AppData/Roaming/Typora/typora-user-images/image-20210305165205976.png)
- Training set 나누기 및 평가
  - Training & Valid set
  - Training에서도 0.95, valid에서도 0.95, Public test set에서도 0.95를 얻었다면 이상적으로 Private test set도 0.95가 나올 것이라고 생각해볼 수 있다.
  - 그러나 현실적으로 Training set 점수 > valid에서의 점수 > public test set에서의 점수로 나오게 되며, 점수 갭이 발생한다.
- 점수 갭을 줄이기 위한 K-Fold 검증 전략 구축
  - ![image-20210305165437093](../../AppData/Roaming/Typora/typora-user-images/image-20210305165437093.png)
  - ![image-20210305165545414](../../AppData/Roaming/Typora/typora-user-images/image-20210305165545414.png)
  - stratified k-fold : 클래스의 비율만큼 validation set을 구축하는 것.
  - 아무리 검증전략을 잘 세워도 오버 피팅의 위험은 존재.
    - local CV와 public LB가 함께 올라가는 방법을 선택
- 기타 꿀팁
  - 앙상블 : 여러 모델의 예측 결과를 섞어서 예측 성능을 향상 시킴.
    - 싱글모델보다 항상 더 좋은 성능을 얻을 수 있음.
    - 여러 방법이 있지만 최근은 아래와 같이 정리되는 추세임.
    - ![image-20210305165729790](../../AppData/Roaming/Typora/typora-user-images/image-20210305165729790.png)
    - 예를 들어, 5개의 모델에 같은 입력을 넣어 출력을 받은 후 이를 평균내서 출력하는 방법.
  - (각각의) 싱글 모델 개선 전략
    - 싱글 모델 점수를 몇 점까지, 언제까지 개선해야할까?
      - 상위 랭커들이 discussion에 언급한 자신의 싱글모델 점수를 참고하자.
      - 대회 종료가 1~2주 정도 남았을 때 싱글모델 점수로만 50등 내에 들면 좋음.
  - 팀을 맺을 때 주의해야 할 점
    - 팀을 맺는 것도 추천
    - But, 한 번 팀을 맺으면 해체가 불가능하다.
    - 동료 후보가 현재 대회에서 높은 순위에 있는지 확인할 필요가 있다.
      - 생각 외로 게으른 사람들이 많다.
  - 코드 관리
    - `v1, v2, v3, ...` 순서로 개별 폴더를 만들어서 코드 관리
    - 버전 별로 전처리된 데이터, 모델 파일을 저장할 수 있는 장점
    - 여러 버전의 모델을 앙상블하기 위해 버전 별 폴더를 추천.
    - github은 최종 버전을 보관하는 용도로만 사용함. 
  - 주피터에서 터미널 열기
    - 주피터 터미널은 크롬 창을 닫아도 살아있으므로 원격학습 가능함!