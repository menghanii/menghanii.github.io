---
title: Numpy와 pyTorch에서 axis, dim 이해하기
categories: [Boostcamp]
tag: [pytorch, numpy]
comments: true
---

## axis, dim

축을 의미한다. `3 X 2` 행렬이 있을 때, 일반적으로 `axis 0`는 `row` 즉 `3`을, `axis 1`은 `columns` 즉 `2`를 나타낸다. (컴퓨터의 숫자는 0부터 시작하므로 첫 번째가 0, 두 번째가 1임을 기억하자.) 행렬이 3차원인 경우를 가정해보자. `3 X 2 X 5` 행렬에서 `axis 0`는 3, `axis 1`은 2, `axis 2`는 5이다. 이렇게 생각하면 어려울 것이 없다.

그러나 문제는 연산을 하는 과정에서 발생한다. 예를 들어 아래와 같은 `2 X 3` 행렬이 있다고 해보자.

<p align="center" width="800px"><img src="https://user-images.githubusercontent.com/37925813/106985171-48e5fd00-67ac-11eb-804d-0d8085e36281.png"></p>

이 행렬을 `axis 0` 기준으로 `sum`해본다고 하자.

```python
import numpy as np
n1 = np.array([[5, 2, 8],
              [3, 6, 9]])
print(n1.shape) # (2, 3)
print(n1.sum(axis=0))
```

어떤 결과가 나올 것이라 생각하십니까? 아마 "`row`를 기준으로 더하는거니까 (5 + 2 + 8) 하고 (3 + 6 + 9)를 더한 값이 나오겠다!" 라고 생각할 것이다. (저는 그랬습니다.) 근데 왠걸 답은 [8 8 17] 즉 `column`에 대해서 더한 값이 나오게 된다. 직관적인 생각과 어긋나서 처음에는 되게 적응하기 어려웠는데, [이 글](https://towardsdatascience.com/understanding-dimensions-in-pytorch-6edf9972d3be)을 보고나서 쉽고도 완벽하게 이해하게 되었다.

**핵심은 해당 `axis`를 `Collapse`시킨다는 것이다.** 즉, 해당 축을 무너뜨린다고 생각하면 나머지 다른 축들을 기준으로 연산을 하게 된다. 위의 예에서는 `axis 0`을 무너뜨리면서 `sum`연산을 하면 된다. 따라서 `2 X 3` 에서 `2`가 무너지고 `3`만 남아야 한다. 따라서 5+3, 2+6, 8+9의 값인 [8 8 17]이 나오게 되는 것이다.

3차원, 4차원, ... , 100차원에서는 어떻게 되는걸까? 마찬가지다. 해당 축을 없앤 나머지 축들을 기준으로 연산하면 된다. 3차원을 예시로 하나만 더 연습해보자. `2 X 3 X 4` 의 3차원 행렬이 있다고 해보자. 여기서 `axis 0`을 기준으로 연산을 하면 `2`가 무너져야 하므로 `3 X 4` 차원의 행렬로 연산이 이루어진다. `axis 1`을 기준으로 하면 `2 X 4` 행렬로 연산 결과가 도출되어야 하며, `axis 2`를 기준으로 하면 `2 X 3` 행렬로 연산결과가 도출되어야 한다. 

'무너뜨린다'라는 개념으로 `axis`와 `dim`을 이해하면 어렵지 않다. (`dim`은 `pyTorch`에서의 `axis`와 같은 개념이다.)